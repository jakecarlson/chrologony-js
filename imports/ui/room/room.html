<template name="room">

    <section id="room" class="{{#if fullBoard}}full-width{{else}}columns{{/if}}">

        {{#if dataReady}}

            <header class="clearfix mb-2">

                <h1 class="float-left" id="roomTitle">{{name}}</h1>

                <div class="float-right mb-2" id="roomMenu">

                    <button
                            class="btn btn-light float-right leave"
                            disabled="{{loading}}"
                    >
                        <i class="fa fa-sign-out"></i>
                        <span class="d-none d-md-inline">Leave Room</span>
                    </button>

                    {{#if isOwner}}
                        <div class="dropdown float-right mr-2">
                            <button class="btn btn-light" type="button" id="invitePlayersButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fa fa-paper-plane"></i>
                                <span class="d-none d-md-inline">Invite Players</span>
                            </button>
                            <div class="dropdown-menu dropdown-menu-right invite-menu" aria-labelledby="invitePlayersButton">
                                {{#if password}}
                                    <a
                                            class="dropdown-item password"
                                            data-clipboard-text="{{password}}"
                                            data-placement="top"
                                            data-trigger="manual"
                                            title="Room Password copied to your clipboard!"
                                            href="{{password}}"
                                    >
                                        <i class="fa fa-key"></i>
                                        Password: <strong>{{password}}</strong>
                                    </a>
                                {{/if}}
                                <a
                                    class="dropdown-item link"
                                    data-clipboard-text="{{link}}"
                                    data-placement="top"
                                    data-trigger="manual"
                                    title="Room URL copied to your clipboard!"
                                    href="{{link}}"
                                >
                                    <i class="fa fa-link"></i>
                                    Copy Room Link
                                </a>
                                <a
                                        class="dropdown-item invite"
                                        data-toggle="modal"
                                        data-target=".invite-modal"
                                        href="#"
                                >
                                    <i class="fa fa-envelope"></i>
                                    Send Invitation
                                </a>
                            </div>
                        </div>
                    {{/if}}

                    {{#if fullBoard}}
                        <button
                            class="btn btn-light float-right d-none d-lg-inline mr-2 board-columns"
                            disabled="{{loading}}"
                        >
                            <i class="fa fa-columns"></i>
                            Columns
                        </button>
                    {{else}}
                        <button
                            class="btn btn-light float-right d-none d-lg-inline mr-2 board-full"
                            disabled="{{loading}}"
                        >
                            <i class="fa fa-arrows-h"></i>
                            Full Width
                        </button>
                    {{/if}}

                </div>

            </header>

            <div class="{{#if columnsBoard}}row{{/if}}">

                <div class="{{#if columnsBoard}}col-lg-9{{/if}}" id="roomMain">

                    {{> board room=currentRoom game=currentGame turn=currentTurn}}

                    {{#if showPlayerCards}}
                        <div id="playerCards" class="mb-4 mb-lg-0">
                            <h2 id="playerCardsTitle" class="text-muted mb-2">
                                {{#if gameInProgress}}
                                    Other
                                {{/if}}
                                Player Cards
                            </h2>
                            {{#each player in players}}
                                {{#if isNotCurrentPlayer player}}
                                    {{> player_cards game=currentGame turn=currentTurn player=player}}
                                {{/if}}
                            {{/each}}
                        </div>
                    {{/if}}

                </div>

                <div class="{{#if columnsBoard}}col-lg-3{{/if}}" id="roomSide">

                    {{> players_list room=currentRoom turn=currentTurn}}

                    {{#if showGameEnd}}
                        <div class="text-center mb-4">
                            <button class="btn btn-sm btn-secondary mr-2 end-game" disabled="{{loading}}">
                                <i class="fa fa-stop-circle"></i>
                                <span>End Game</span>
                            </button>
                            <button class="btn btn-sm btn-light abandon-game" disabled="{{loading}}">
                                <i class="fa fa-remove"></i>
                                <span>Abandon Game</span>
                            </button>
                        </div>
                    {{/if}}

                    {{#if isOwner}}

                        {{> game room=currentRoom game=currentGame turn=currentTurn}}

                        <div class="text-center">
                            <button class="btn btn-outline-danger destroy" disabled="{{loading}}">
                                <i class="fa fa-trash"></i>
                                <span>Delete Room</span>
                            </button>
                        </div>

                    {{/if}}

                </div>

            </div>

            <div class="modal fade" id="clueMore" tabindex="-1" role="dialog" aria-labelledby="clueMoreTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">

                        <div class="modal-header">
                            <h5 class="modal-title" id="clueMoreTitle">{{moreName}}: More Info</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>

                        <div class="modal-body">

                            {{#if hasMoreImage}}
                                <a href="{{moreImageUrl}}" target="blank" class="float-left mr-4 mb-2"><img src="{{moreThumbnailUrl}}" class="more-img"></a>
                            {{/if}}

                            {{#if hasMoreAttr 'moreInfo'}}
                                <p class="more-info">{{moreAttr 'moreInfo'}}</p>
                            {{/if}}

                            {{#if hasMoreLocation}}
                                <div class="more-map mb-3">
                                    <iframe
                                        width="100%"
                                        height="100%"
                                        frameborder="0" style="border:0"
                                        src="{{moreMapUrl}}" allowfullscreen>
                                    </iframe>
                                </div>
                            {{/if}}

                            {{#if hasMoreAttr 'externalId'}}
                                <span class="more-id float-left text-muted" title="External ID">{{moreAttr 'externalId'}}</span>
                            {{/if}}

                            {{#if hasMoreAttr 'externalUrl'}}
                                <a href="{{moreAttr 'externalUrl'}}" class="more-url float-right" target="_blank">Read More <i class="fa fa-external-link"></i></a>
                            {{/if}}

                        </div>

                    </div>
                </div>
            </div>

        {{/if}}

    </section>

    {{#if isOwner}}
        <div class="modal fade invite-modal" tabindex="-1" role="dialog" aria-labelledby="inviteTitle" aria-hidden="true">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="inviteTitle">Invite a Player</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="model-body">
                        <form class="form-inline justify-content-center p-2" id="invitePlayer">
                            <label class="sr-only" for="inviteEmail">Email</label>
                            <input type="email" name="email" class="form-control mr-2 attr" id="inviteEmail" placeholder="Email">
                            <button type="submit" class="btn btn-primary"><i class="fa fa-paper-plane"></i> Invite</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    {{/if}}

</template>